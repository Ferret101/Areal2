<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Landkreis Gie√üen | Wegweiser - DESIGN PLAYGROUND</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            height: 100vh;
            overflow: hidden;
            margin: 0;
            padding: 0;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="80" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="20" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="10" cy="60" r="2.5" fill="rgba(255,255,255,0.1)"/><circle cx="70" cy="70" r="1" fill="rgba(255,255,255,0.1)"/></svg>');
            z-index: -1;
            opacity: 0.7;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0 0 30px 30px;
            color: #fff;
            padding: 40px 20px 25px 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        .header .main-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .header h1 {
            color: #fff;
            font-size: 1.6em;
            margin: 0 0 12px 0;
            font-weight: 600;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .language-select {
            padding: 12px 8px 12px 45px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            background: rgba(83, 175, 50, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(83, 175, 50, 0.2);
            font-size: 14px;
            position: relative;
        }
        .language-select option {
            background: #53AF32;
            color: #fff;
        }
        .language-select:hover {
            background: rgba(69, 160, 73, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(83, 175, 50, 0.4);
            border-color: rgba(255, 255, 255, 0.4);
        }
        .locate-btn {
            padding: 10px 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            background: rgba(0, 93, 170, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #fff;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 93, 170, 0.2);
        }
        .locate-btn:hover {
            background: rgba(83, 175, 50, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(83, 175, 50, 0.3);
            border-color: rgba(255, 255, 255, 0.4);
        }
        .map-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            padding: 0;
            box-shadow: none;
            position: relative;
            overflow: hidden;
        }
        #map {
            height: 100%;
            width: 100%;
            border-radius: 0;
            box-shadow: none;
            background: #f0f0f0;
            min-height: 400px;
        }
        /* Leaflet-specific Styles */
        .leaflet-container {
            background: #f0f0f0;
        }
        .leaflet-tile-pane {
            opacity: 1;
        }
        .building-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            border: 2px solid #4C8C2B;
            padding: 1em;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transform: translateY(calc(100% + 40px));
            transition: transform 0.3s ease;
            z-index: 1000;
            max-height: 60vh;
            overflow-y: auto;
        }
        .building-info.show {
            transform: translateY(0);
        }
        .building-info h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        .building-info ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .building-info li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            font-size: 0.9em;
        }
        .building-info li:last-child {
            border-bottom: none;
        }
        .close-info {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
            padding: 5px;
        }
        .status {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            color: #666;
            box-shadow: none;
            z-index: 1000;
        }
        .leaflet-popup-content {
            font-family: inherit;
            font-size: 14px;
            line-height: 1.4;
        }
        .leaflet-popup-content h4 {
            margin: 0 0 8px 0;
            color: #2c3e50;
        }
        .user-location-arrow {
            background: none !important;
            border: none !important;
            box-shadow: 2px 2px 6px rgba(0,0,0,0.3) !important;
            filter: drop-shadow(0 0 3px rgba(0, 122, 255, 0.8));
        }
        .building-marker {
            background: none !important;
            border: none !important;
        }
        .building-marker:hover {
            transform: scale(1.1);
            transition: transform 0.2s ease;
        }
        @media (max-width: 768px) {
            .container {
                padding: 0;
            }
            .header {
                padding: 35px 20px 20px 20px;
                margin-bottom: 0;
            }
            .header h1 {
                font-size: 1.5em;
            }
            .controls {
                gap: 10px;
            }
            .building-info {
                bottom: 10px;
                left: 10px;
                right: 10px;
                max-height: 50vh;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="main-title">LKGi - Wegweiser</div>
            <h1 id="title">Landkreis Gie√üen | Wegweiser</h1>
            <div class="controls">
                <div style="position: relative; display: inline-block;">
                    <span style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); background: #fff; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 11px; z-index: 1;">üåê</span>
                    <select id="languageSelect" class="language-select">
                        <option value="de">Deutsch</option>
                        <option value="en">English</option>
                        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                        <option value="fr">Fran√ßais</option>
                        <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                    </select>
                </div>
                <button id="locateBtn" class="locate-btn" title="üìç">üìç</button>
            </div>
        </div>

        <div class="map-container">
            <div id="map"></div>
            <div id="status" class="status">L√§dt...</div>
            <div class="building-info" id="buildingInfo">
                <button class="close-info" onclick="hideInfo()">√ó</button>
                <h3 id="buildingTitle"></h3>
                <ul id="buildingContent"></ul>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    <script>
        // Globale Variablen
        let map;
        let userMarker;
        let currentLanguage = 'de';
        let buildingMarkers = [];

        // √úbersetzungen
        const translations = {
            de: {
                title: "Landkreis Gie√üen | Wegweiser",
                locateButton: "Mein Standort",
                loading: "L√§dt...",
                mapLoaded: "Karte geladen",
                locationNotSupported: "Geolocation wird nicht unterst√ºtzt",
                locationError: "Standort konnte nicht ermittelt werden",
                userLocation: "Ihr Standort",
                locationFound: "Standort gefunden",
                accuracy: "Genauigkeit",
                gebaudeA: "Geb√§ude A",
                gebaudeB: "Geb√§ude B", 
                gebaudeC: "Geb√§ude C",
                gebaudeD: "Geb√§ude D",
                gebaudeE: "Geb√§ude E",
                gebaudeF: "Geb√§ude F",
                gebaudeG: "Geb√§ude G",
                info: "Info",
                buildingInfo: {
                    "Geb√§ude A": [
                        "Hauptverwaltung",
                        "B√ºrgerb√ºro",
                        "Landrat",
                        "Kreisausschuss"
                    ],
                    "Geb√§ude B": [
                        "Soziales",
                        "Jugendamt",
                        "Gesundheitsamt",
                        "Veterin√§ramt"
                    ],
                    "Geb√§ude C": [
                        "Ordnungsamt",
                        "Ausl√§nderamt",
                        "Stra√üenverkehrsamt",
                        "F√ºhrerscheinstelle"
                    ],
                    "Geb√§ude D": [
                        "Bauamt",
                        "Umweltamt",
                        "Planungsamt",
                        "Vermessungsamt"
                    ],
                    "Geb√§ude E": [
                        "Finanzen",
                        "Personal",
                        "Organisation",
                        "IT-Service"
                    ],
                    "Geb√§ude F": [
                        "Schule & Bildung",
                        "Kultur",
                        "Sport",
                        "Ehrenamt"
                    ],
                    "Geb√§ude G": [
                        "Wirtschaftsf√∂rderung",
                        "√ñPNV",
                        "Tourismus",
                        "Europa-B√ºro"
                    ],
                    "Info": [
                        "Information",
                        "Wegweiser",
                        "Anmeldung",
                        "Sicherheitsdienst"
                    ]
                }
            },
            en: {
                title: "Landkreis Gie√üen | Wegweiser",
                locateButton: "My Location",
                loading: "Loading...",
                mapLoaded: "Map loaded",
                locationNotSupported: "Geolocation is not supported",
                locationError: "Could not determine location",
                userLocation: "Your Location",
                locationFound: "Location found",
                accuracy: "Accuracy",
                gebaudeA: "Building A",
                gebaudeB: "Building B",
                gebaudeC: "Building C", 
                gebaudeD: "Building D",
                gebaudeE: "Building E",
                gebaudeF: "Building F",
                gebaudeG: "Building G",
                info: "Info",
                buildingInfo: {
                    "Geb√§ude A": [
                        "Main Administration",
                        "Citizens' Office",
                        "District Administrator",
                        "District Committee"
                    ],
                    "Geb√§ude B": [
                        "Social Services",
                        "Youth Office",
                        "Health Department",
                        "Veterinary Office"
                    ],
                    "Geb√§ude C": [
                        "Public Order Office",
                        "Immigration Office",
                        "Road Traffic Office",
                        "Driver's License Office"
                    ],
                    "Geb√§ude D": [
                        "Building Department",
                        "Environmental Office",
                        "Planning Office",
                        "Surveying Office"
                    ],
                    "Geb√§ude E": [
                        "Finance",
                        "Human Resources",
                        "Organization",
                        "IT Service"
                    ],
                    "Geb√§ude F": [
                        "Education",
                        "Culture",
                        "Sports",
                        "Volunteering"
                    ],
                    "Geb√§ude G": [
                        "Economic Development",
                        "Public Transport",
                        "Tourism",
                        "Europe Office"
                    ],
                    "Info": [
                        "Information",
                        "Directory",
                        "Registration",
                        "Security Service"
                    ]
                }
            },
            ar: {
                title: "Landkreis Gie√üen | Wegweiser",
                locateButton: "ŸÖŸàŸÇÿπŸä",
                loading: "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...",
                mapLoaded: "ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ©",
                locationNotSupported: "ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ",
                locationError: "ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ",
                userLocation: "ŸÖŸàŸÇÿπŸÉ",
                locationFound: "ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ",
                accuracy: "ÿßŸÑÿØŸÇÿ©",
                gebaudeA: "ÿßŸÑŸÖÿ®ŸÜŸâ ÿ£",
                gebaudeB: "ÿßŸÑŸÖÿ®ŸÜŸâ ÿ®",
                gebaudeC: "ÿßŸÑŸÖÿ®ŸÜŸâ ÿ¨",
                gebaudeD: "ÿßŸÑŸÖÿ®ŸÜŸâ ÿØ",
                gebaudeE: "ÿßŸÑŸÖÿ®ŸÜŸâ ŸáŸÄ",
                gebaudeF: "ÿßŸÑŸÖÿ®ŸÜŸâ Ÿà",
                gebaudeG: "ÿßŸÑŸÖÿ®ŸÜŸâ ÿ≤",
                info: "ŸÖÿπŸÑŸàŸÖÿßÿ™",
                buildingInfo: {
                    "Geb√§ude A": [
                        "ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑŸÖŸàÿßÿ∑ŸÜŸäŸÜ",
                        "ŸÖÿØŸäÿ± ÿßŸÑŸÖŸÇÿßÿ∑ÿπÿ©",
                        "ŸÑÿ¨ŸÜÿ© ÿßŸÑŸÖŸÇÿßÿ∑ÿπÿ©"
                    ],
                    "Geb√§ude B": [
                        "ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸäÿ©",
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑÿ¥ÿ®ÿßÿ®",
                        "ÿØÿßÿ¶ÿ±ÿ© ÿßŸÑÿµÿ≠ÿ©",
                        "ÿßŸÑŸÖŸÉÿ™ÿ® ÿßŸÑÿ®Ÿäÿ∑ÿ±Ÿä"
                    ],
                    "Geb√§ude C": [
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿπÿßŸÖ",
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑŸáÿ¨ÿ±ÿ©",
                        "ŸÖŸÉÿ™ÿ® ÿ≠ÿ±ŸÉÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        "ŸÖŸÉÿ™ÿ® ÿ±ÿÆÿµÿ© ÿßŸÑŸÇŸäÿßÿØÿ©"
                    ],
                    "Geb√§ude D": [
                        "ÿØÿßÿ¶ÿ±ÿ© ÿßŸÑÿ®ŸÜÿßÿ°",
                        "ÿßŸÑŸÖŸÉÿ™ÿ® ÿßŸÑÿ®Ÿäÿ¶Ÿä",
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑",
                        "ŸÖŸÉÿ™ÿ® ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ©"
                    ],
                    "Geb√§ude E": [
                        "ÿßŸÑŸÖÿßŸÑŸäÿ©",
                        "ÿßŸÑŸÖŸàÿßÿ±ÿØ ÿßŸÑÿ®ÿ¥ÿ±Ÿäÿ©",
                        "ÿßŸÑÿ™ŸÜÿ∏ŸäŸÖ",
                        "ÿÆÿØŸÖÿ© ÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™"
                    ],
                    "Geb√§ude F": [
                        "ÿßŸÑÿ™ÿπŸÑŸäŸÖ",
                        "ÿßŸÑÿ´ŸÇÿßŸÅÿ©",
                        "ÿßŸÑÿ±Ÿäÿßÿ∂ÿ©",
                        "ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿ™ÿ∑ŸàÿπŸä"
                    ],
                    "Geb√§ude G": [
                        "ÿßŸÑÿ™ŸÜŸÖŸäÿ© ÿßŸÑÿßŸÇÿ™ÿµÿßÿØŸäÿ©",
                        "ÿßŸÑŸÜŸÇŸÑ ÿßŸÑÿπÿßŸÖ",
                        "ÿßŸÑÿ≥Ÿäÿßÿ≠ÿ©",
                        "ŸÖŸÉÿ™ÿ® ÿ£Ÿàÿ±Ÿàÿ®ÿß"
                    ],
                    "Info": [
                        "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™",
                        "ÿßŸÑÿØŸÑŸäŸÑ",
                        "ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ",
                        "ÿÆÿØŸÖÿ© ÿßŸÑÿ£ŸÖŸÜ"
                    ]
                }
            },
            fr: {
                title: "Landkreis Gie√üen | Wegweiser",
                locateButton: "Ma Position",
                loading: "Chargement...",
                mapLoaded: "Carte charg√©e",
                locationNotSupported: "La g√©olocalisation n'est pas prise en charge",
                locationError: "Impossible de d√©terminer la position",
                userLocation: "Votre Position",
                locationFound: "Position trouv√©e",
                accuracy: "Pr√©cision",
                gebaudeA: "B√¢timent A",
                gebaudeB: "B√¢timent B",
                gebaudeC: "B√¢timent C",
                gebaudeD: "B√¢timent D", 
                gebaudeE: "B√¢timent E",
                gebaudeF: "B√¢timent F",
                gebaudeG: "B√¢timent G",
                info: "Info",
                buildingInfo: {
                    "Geb√§ude A": [
                        "Administration Principale",
                        "Bureau des Citoyens",
                        "Administrateur du District",
                        "Comit√© du District"
                    ],
                    "Geb√§ude B": [
                        "Services Sociaux",
                        "Bureau de la Jeunesse",
                        "D√©partement de la Sant√©",
                        "Bureau V√©t√©rinaire"
                    ],
                    "Geb√§ude C": [
                        "Bureau de l'Ordre Public",
                        "Bureau de l'Immigration",
                        "Bureau de la Circulation",
                        "Bureau du Permis de Conduire"
                    ],
                    "Geb√§ude D": [
                        "D√©partement de la Construction",
                        "Bureau de l'Environnement",
                        "Bureau de Planification",
                        "Bureau d'Arpentage"
                    ],
                    "Geb√§ude E": [
                        "Finance",
                        "Ressources Humaines",
                        "Organisation",
                        "Service Informatique"
                    ],
                    "Geb√§ude F": [
                        "√âducation",
                        "Culture",
                        "Sports",
                        "B√©n√©volat"
                    ],
                    "Geb√§ude G": [
                        "D√©veloppement √âconomique",
                        "Transport Public",
                        "Tourisme",
                        "Bureau Europe"
                    ],
                    "Info": [
                        "Information",
                        "R√©pertoire",
                        "Inscription",
                        "Service de S√©curit√©"
                    ]
                }
            },
            uk: {
                title: "Landkreis Gie√üen | Wegweiser",
                locateButton: "–ú–æ—î –ú—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è",
                loading: "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...",
                mapLoaded: "–ö–∞—Ä—Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞",
                locationNotSupported: "–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è",
                locationError: "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è",
                userLocation: "–í–∞—à–µ –ú—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è",
                locationFound: "–ú—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–Ω–∞–π–¥–µ–Ω–æ",
                accuracy: "–¢–æ—á–Ω—ñ—Å—Ç—å",
                gebaudeA: "–ë—É–¥—ñ–≤–ª—è –ê",
                gebaudeB: "–ë—É–¥—ñ–≤–ª—è –ë",
                gebaudeC: "–ë—É–¥—ñ–≤–ª—è –í",
                gebaudeD: "–ë—É–¥—ñ–≤–ª—è –ì",
                gebaudeE: "–ë—É–¥—ñ–≤–ª—è –î",
                gebaudeF: "–ë—É–¥—ñ–≤–ª—è –ï",
                gebaudeG: "–ë—É–¥—ñ–≤–ª—è –ñ",
                info: "–Ü–Ω—Ñ–æ",
                buildingInfo: {
                    "Geb√§ude A": [
                        "–ì–æ–ª–æ–≤–Ω–∞ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è",
                        "–û—Ñ—ñ—Å –ì—Ä–æ–º–∞–¥—è–Ω",
                        "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –û–∫—Ä—É–≥—É",
                        "–ö–æ–º—ñ—Ç–µ—Ç –û–∫—Ä—É–≥—É"
                    ],
                    "Geb√§ude B": [
                        "–°–æ—Ü—ñ–∞–ª—å–Ω—ñ –ü–æ—Å–ª—É–≥–∏",
                        "–ú–æ–ª–æ–¥—ñ–∂–Ω–∏–π –û—Ñ—ñ—Å",
                        "–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –û—Ö–æ—Ä–æ–Ω–∏ –ó–¥–æ—Ä–æ–≤'—è",
                        "–í–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω–∏–π –û—Ñ—ñ—Å"
                    ],
                    "Geb√§ude C": [
                        "–û—Ñ—ñ—Å –ì—Ä–æ–º–∞–¥—Å—å–∫–æ–≥–æ –ü–æ—Ä—è–¥–∫—É",
                        "–Ü–º–º—ñ–≥—Ä–∞—Ü—ñ–π–Ω–∏–π –û—Ñ—ñ—Å",
                        "–û—Ñ—ñ—Å –î–æ—Ä–æ–∂–Ω—å–æ–≥–æ –†—É—Ö—É",
                        "–û—Ñ—ñ—Å –í–æ–¥—ñ–π—Å—å–∫–∏—Ö –ü—Ä–∞–≤"
                    ],
                    "Geb√§ude D": [
                        "–ë—É–¥—ñ–≤–µ–ª—å–Ω–∏–π –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç",
                        "–ï–∫–æ–ª–æ–≥—ñ—á–Ω–∏–π –û—Ñ—ñ—Å",
                        "–û—Ñ—ñ—Å –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è",
                        "–û—Ñ—ñ—Å –ó–µ–º–ª–µ–º—ñ—Ä—Å—Ç–≤–∞"
                    ],
                    "Geb√§ude E": [
                        "–§—ñ–Ω–∞–Ω—Å–∏",
                        "–õ—é–¥—Å—å–∫—ñ –†–µ—Å—É—Ä—Å–∏",
                        "–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è",
                        "–Ü–¢ –°–ª—É–∂–±–∞"
                    ],
                    "Geb√§ude F": [
                        "–û—Å–≤—ñ—Ç–∞",
                        "–ö—É–ª—å—Ç—É—Ä–∞",
                        "–°–ø–æ—Ä—Ç",
                        "–í–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ"
                    ],
                    "Geb√§ude G": [
                        "–ï–∫–æ–Ω–æ–º—ñ—á–Ω–∏–π –†–æ–∑–≤–∏—Ç–æ–∫",
                        "–ì—Ä–æ–º–∞–¥—Å—å–∫–∏–π –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç",
                        "–¢—É—Ä–∏–∑–º",
                        "–û—Ñ—ñ—Å –Ñ–≤—Ä–æ–ø–∏"
                    ],
                    "Info": [
                        "–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è",
                        "–î–æ–≤—ñ–¥–Ω–∏–∫",
                        "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è",
                        "–°–ª—É–∂–±–∞ –ë–µ–∑–ø–µ–∫–∏"
                    ]
                }
            }
        };

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
            setupEventListeners();
            updateLanguage();
        });

        function setupEventListeners() {
            // Sprache √§ndern
            document.getElementById('languageSelect').addEventListener('change', function(e) {
                currentLanguage = e.target.value;
                updateLanguage();
            });

            // GPS-Lokalisierung
            document.getElementById('locateBtn').addEventListener('click', locateUser);
        }

        function updateLanguage() {
            const t = translations[currentLanguage];
            document.getElementById('title').textContent = t.title;
            document.getElementById('locateBtn').textContent = `üìç ${t.locateButton}`;
            document.getElementById('status').textContent = t.loading;
            
            // Schlie√üe Info-Panel beim Sprachwechsel
            hideInfo();
            
            // Aktualisiere Marker-Labels falls die Karte bereits geladen ist
            if (map && buildingMarkers.length > 0) {
                updateMarkerLabels();
            }
        }

        function updateMarkerLabels() {
            const t = translations[currentLanguage];
            
            buildingMarkers.forEach(markerData => {
                const { marker, name } = markerData;
                let displayName = name;
                
                // √úbersetze Geb√§ude-Namen entsprechend der Sprache
                switch(name) {
                    case "Geb√§ude A": displayName = t.gebaudeA; break;
                    case "Geb√§ude B": displayName = t.gebaudeB; break;
                    case "Geb√§ude C": displayName = t.gebaudeC; break;
                    case "Geb√§ude D": displayName = t.gebaudeD; break;
                    case "Geb√§ude E": displayName = t.gebaudeE; break;
                    case "Geb√§ude F": displayName = t.gebaudeF; break;
                    case "Geb√§ude G": displayName = t.gebaudeG; break;
                    case "Info": displayName = t.info; break;
                }
                
                // Bestimme Marker-Text (Buchstabe f√ºr Geb√§ude, "I" f√ºr Info)
                let markerText = name === "Info" ? "I" : displayName.slice(-1);
                
                // Aktualisiere Marker-Icon mit √ºbersetztem Text und besserer Zentrierung
                marker.setIcon(L.divIcon({
                    html: `<div style="width: 20px; height: 20px; border: 3px solid #fff; border-radius: 50%; background: #0072BC; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; box-shadow: 0 4px 12px rgba(0, 114, 188, 0.4);">${markerText}</div>`,
                    iconSize: [26, 26],
                    iconAnchor: [13, 13],
                    className: 'building-marker'
                }));
            });
        }

        function initializeMap() {
            try {
                // √úberpr√ºfe ob Leaflet geladen ist
                if (typeof L === 'undefined') {
                    console.error('Leaflet not loaded!');
                    document.getElementById('status').textContent = translations[currentLanguage].loading;
                    return;
                }

                // Erstelle die Karte (AMTLICHE Koordinaten - Zentrum zwischen den Geb√§uden)
                map = L.map('map').setView([50.5749, 8.7089], 18);

                // Definiere Grenzen f√ºr die Kartenansicht (ca. 200m Radius um das Zentrum)
                const bounds = L.latLngBounds(
                    [50.5729, 8.7069], // Southwest corner
                    [50.5769, 8.7109]  // Northeast corner
                );
                map.setMaxBounds(bounds);
                map.on('drag', function() {
                    map.panInsideBounds(bounds, { animate: false });
                });

                // F√ºge Tiles hinzu
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    maxZoom: 19,
                    minZoom: 17, // Erlaube ca. 100m weiteres Rauszoomen
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);

                // Status aktualisieren
                document.getElementById('status').textContent = translations[currentLanguage].mapLoaded;

                // Geb√§ude-Marker hinzuf√ºgen (AMTLICHE KOORDINATEN)
                const buildings = {
                    "Geb√§ude A": [50.57518992739294816, 8.70838573811109384],
                    "Geb√§ude B": [50.57454581481103162, 8.7077837800067357], 
                    "Geb√§ude C": [50.57415466848566865, 8.70829926653693676],
                    "Geb√§ude D": [50.57438623824244672, 8.70939668314574433],
                    "Geb√§ude E": [50.57504732952577342, 8.71001457548033819],
                    "Geb√§ude F": [50.57573098437185877, 8.7097731683841797],
                    "Geb√§ude G": [50.5758340204584016, 8.70898754079399851],
                    "Info": [50.57392270241523136, 8.70897560380057634]
                };

                // F√ºge Geb√§ude-Marker hinzu
                Object.entries(buildings).forEach(([name, coords]) => {
                    const t = translations[currentLanguage];
                    let displayName = name;
                    
                    // √úbersetze Geb√§ude-Namen entsprechend der Sprache
                    switch(name) {
                        case "Geb√§ude A": displayName = t.gebaudeA; break;
                        case "Geb√§ude B": displayName = t.gebaudeB; break;
                        case "Geb√§ude C": displayName = t.gebaudeC; break;
                        case "Geb√§ude D": displayName = t.gebaudeD; break;
                        case "Geb√§ude E": displayName = t.gebaudeE; break;
                        case "Geb√§ude F": displayName = t.gebaudeF; break;
                        case "Geb√§ude G": displayName = t.gebaudeG; break;
                        case "Info": displayName = t.info; break;
                    }
                    
                    // Bestimme Marker-Text (Buchstabe f√ºr Geb√§ude, "I" f√ºr Info)
                    let markerText = name === "Info" ? "I" : displayName.slice(-1);
                    
                    const buildingMarker = L.marker(coords, {
                        icon: L.divIcon({
                            html: `<div style="width: 20px; height: 20px; border: 3px solid #fff; border-radius: 50%; background: #0072BC; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; box-shadow: 0 4px 12px rgba(0, 114, 188, 0.4);">${markerText}</div>`,
                            iconSize: [26, 26],
                            iconAnchor: [13, 13],
                            className: 'building-marker'
                        })
                    }).addTo(map);

                    // Speichere Marker f√ºr sp√§tere Updates
                    buildingMarkers.push({ marker: buildingMarker, name: name });

                    // Click-Event f√ºr detaillierte Informationen mit Toggle-Funktion
                    buildingMarker.on('click', function() {
                        const buildingInfoPanel = document.getElementById('buildingInfo');
                        const currentTitle = document.getElementById('buildingTitle').textContent;
                        
                        // Wenn das gleiche Geb√§ude bereits angezeigt wird, schlie√üe das Panel
                        if (buildingInfoPanel.classList.contains('show') && currentTitle === displayName) {
                            hideInfo();
                        } else {
                            showBuildingInfo(name);
                        }
                    });
                });

            } catch (error) {
                console.error('Error initializing map:', error);
                document.getElementById('status').textContent = 'Fehler: ' + error.message;
            }
        }

        function locateUser() {
            if (!navigator.geolocation) {
                alert(translations[currentLanguage].locationNotSupported);
                return;
            }

            document.getElementById('status').textContent = translations[currentLanguage].loading;

            // Einfache einmalige Positionsabfrage - sofortiger Standort
            navigator.geolocation.getCurrentPosition(function(position) {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                const heading = position.coords.heading || 0;
                const accuracy = position.coords.accuracy;
                const t = translations[currentLanguage];

                // Entferne vorherigen Benutzer-Marker
                if (userMarker) {
                    map.removeLayer(userMarker);
                }

                // Erstelle Richtungspfeil
                const arrowIcon = L.divIcon({
                    html: `<div style="transform: rotate(${heading}deg); font-size: 24px; text-align: center; line-height: 1; color: #007AFF;">‚ñ≤</div>`,
                    iconSize: [30, 30],
                    iconAnchor: [15, 15],
                    className: 'user-location-arrow'
                });

                // F√ºge Benutzer-Marker hinzu
                userMarker = L.marker([lat, lng], {
                    icon: arrowIcon
                }).addTo(map);

                // Zentriere Karte auf Benutzerposition
                map.setView([lat, lng], 17);

                document.getElementById('status').textContent = `${t.locationFound} (¬±${Math.round(accuracy)}m)`;

            }, function(error) {
                console.error('Geolocation error:', error);
                document.getElementById('status').textContent = translations[currentLanguage].locationError;
            }, {
                enableHighAccuracy: true,
                timeout: 15000,
                maximumAge: 30000
            });
        }

        // Entferne die komplexen Tracking-Funktionen
        function startTracking() {
            // Nicht mehr verwendet
        }

        function stopTracking() {
            // Nicht mehr verwendet
        }

        function updateUserPosition(position) {
            // Nicht mehr verwendet
        }

        function handleLocationError(error) {
            // Nicht mehr verwendet
        }

        function showBuildingInfo(buildingName) {
            const t = translations[currentLanguage];
            const info = t.buildingInfo[buildingName];
            
            if (!info) return;

            // √úbersetze Geb√§ude-Name f√ºr Anzeige
            let displayName = buildingName;
            switch(buildingName) {
                case "Geb√§ude A": displayName = t.gebaudeA; break;
                case "Geb√§ude B": displayName = t.gebaudeB; break;
                case "Geb√§ude C": displayName = t.gebaudeC; break;
                case "Geb√§ude D": displayName = t.gebaudeD; break;
                case "Geb√§ude E": displayName = t.gebaudeE; break;
                case "Geb√§ude F": displayName = t.gebaudeF; break;
                case "Geb√§ude G": displayName = t.gebaudeG; break;
                case "Info": displayName = t.info; break;
            }

            document.getElementById('buildingTitle').textContent = displayName;
            
            const contentList = document.getElementById('buildingContent');
            contentList.innerHTML = '';
            
            info.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                contentList.appendChild(li);
            });

            document.getElementById('buildingInfo').classList.add('show');
        }

        function hideInfo() {
            document.getElementById('buildingInfo').classList.remove('show');
        }
    </script>
</body>
</html>
